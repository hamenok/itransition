{% extends 'main/index.html.twig' %}

{% block title %}{% trans %}VIEW ITEM{% endtrans %}{% endblock %}

{% block content %}
<style>
    .img-sm {
        width: 46px;
        height: 46px;
    }

    .panel {
        box-shadow: 0 2px 0 rgba(0, 0, 0, 0.075);
        border-radius: 0;
        border: 0;
        margin-bottom: 15px;
    }

    .panel .panel-footer,
    .panel>:last-child {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }

    .panel .panel-heading,
    .panel>:first-child {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
    }

    .panel-body {
        padding: 25px 20px;
    }

    .media-block .media-left {
        display: block;
        float: left
    }

    .media-block .media-right {
        float: right
    }

    .media-block .media-body {
        display: block;
        overflow: hidden;
        width: auto
    }

    .middle .media-left,
    .middle .media-right,
    .middle .media-body {
        vertical-align: middle
    }

    .thumbnail {
        border-radius: 0;
        border-color: #e9e9e9
    }

    .tag.tag-sm,
    .btn-group-sm>.tag {
        padding: 5px 10px;
    }

    .tag:not(.label) {
        background-color: #fff;
        padding: 6px 12px;
        border-radius: 2px;
        border: 1px solid #cdd6e1;
        font-size: 12px;
        line-height: 1.42857;
        vertical-align: middle;
        -webkit-transition: all .15s;
        transition: all .15s;
    }

    .text-muted,
    a.text-muted:hover,
    a.text-muted:focus {
        color: #acacac;
    }

    .text-sm {
        font-size: 0.9em;
    }

    .text-5x,
    .text-4x,
    .text-5x,
    .text-2x,
    .text-lg,
    .text-sm,
    .text-xs {
        line-height: 1.25;
    }

    .btn-trans {
        background-color: transparent;
        border-color: transparent;
        color: #929292;
    }

    .btn-icon {
        padding-left: 9px;
        padding-right: 9px;
    }

    .btn-sm,
    .btn-group-sm>.btn,
    .btn-icon.btn-sm {
        padding: 5px 10px !important;
    }

    .mar-top {
        margin-top: 15px;
    }
</style>
<div class="d-flex justify-content-center mt-3">
    <h1 class="display-6">{% trans %}VIEW ITEM{% endtrans %}</h1>
</div>
<div class="container">
    <div class="d-flex justify-content-center mb-4">
        <div class="card shadow-sm mt-3" style="width: 60rem;">
            <div class="card-header h4">
                <strong
                    class="d-inline-block text-primary">{% trans %}ITEM{% endtrans %}&nbsp;#{{ items[0]['id'] }}</strong>
            </div>
            <div class="col p-4 d-flex flex-row ">
                <div class="col-md-8">
                    <div class="card-body">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="align-bottom">
                                        <p class="form-label">{% trans %}TITLE{% endtrans %}</P>
                                    </td>
                                    <th scope="row">
                                        {{ items[0]['nameItem'] }}
                                    </th>
                                </tr>
                                <tr>
                                    <td class="align-bottom">
                                        <p class="form-label">{% trans %}TAGS{% endtrans %}</P>
                                    </td>
                                    <th scope="row">
                                        <p>
                                            {% set comma = "," %}
                                            {% for tag in items[0]['tagItem'] %}
                                                {% if tag != null %}
                                                    {{ tag }}
                                                    {% if loop.last != true %}
                                                        {{ comma }}
                                                    {% endif %}
                                                {% endif %}
                                            {% endfor %}
                                        </p>
                                    </th>
                                </tr>
                                <tr>
                                    <td class="align-bottom">
                                        <p class="form-label">{% trans %}NAME AUTHOR{% endtrans %}</P>
                                    </td>
                                    <th scope="row">
                                        {{ items[0]['firstname'] }}{{ items[0]['lastname'] }}
                                    </th>
                                </tr>
                                <tr>
                                    <td class="align-bottom">
                                        <p class="form-label">{% trans %}EMAIL AUTHOR{% endtrans %}</P>
                                    </td>
                                    <th scope="row">
                                        {{ items[0]['email'] }}
                                    </th>
                                </tr>
                                <tr>
                                    <td class="align-bottom">
                                        <p class="form-label">{% trans %}DATE CREATE{% endtrans %}</P>
                                    </td>
                                    <th scope="row">
                                        {{ items[0]['datecreateitem']|date('Y:m:d H:m') }}
                                    </th>
                                </tr>
                                <tr>
                                    <td class="align-bottom">
                                        <p class="form-label">{% trans %}LIKE{% endtrans %}</P>
                                    </td>
                                    <th scope="row">
                                        <i class="fa fa-user" aria-hidden="true"></i>0
                                    </th>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-md-4">
                    {% if (items[0]['imageItems']) %}
                        <img src="{{ asset('images/items/') }}{{ items[0]['imageItems'] }}" class="img-fluid rounded-end"
                            alt="{% trans %}ITEM IMAGE{% endtrans %}">
                    {% else %}
                        <img src="{{ asset('images/items/no-item-photo.png') }}" class="img-fluid rounded-end"
                            alt="{% trans %}IMAGE NOT FOUND{% endtrans %}">
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <div class="commentaries row justify-content-center">
        <div class="col-md-10">
            <div class="card">
                <div class="card-header"><strong>{% trans %}Commentaries{% endtrans %}</strong></div>
                {% if is_granted('ROLE_USER') %}    
                    <div class="card-body">
                        {% for message in app.flashes('success') %}
                            <div class="alert alert-success alert-dismissible fade show text-center" role="alert">
                                <strong>{{ message|trans }}</strong>
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                        {% for message in app.flashes('error') %}
                            <div class="alert alert-danger alert-dismissible fade show text-center" role="alert">
                                <strong>{{ message|trans }}</strong>
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                        
                        {{ form_start(addComment,{'action': path('add.comment',{'itemID': items[0]['id'], 'userID': app.user.id})}) }}
                            {{ form_row(addComment.message) }}
                                <div class="mar-top d-flex justify-content-center">
                                    <button class="btn btn-sm btn-primary pull-right btn-block w-50" id="sendcomment" type="submit" url={{path('add.comment',{'itemID': items[0]['id'], 'userID': app.user.id})}}><i
                                            class="fa fa-pencil fa-fw"></i>{% trans %}Add{% endtrans %}</button>
                                </div>
                        {{ form_end(addComment) }}
                    </div>
                {% endif %}
            </div>
            <div class="panel">
                <div class="panel-body">
                    {% for msg in allmsg %}
                        <div class="media-block">
                            <div class="media-left me-2" href="#"><img class="img-circle img-sm" alt="Профиль пользователя"
                                    src="{{ asset('images/users/') }}{{ allmsg[loop.index-1].avatar }}"></div>
                            <div class="media-body">
                                <div class="mar-btm">
                                    <a href="#" class="btn-link text-semibold media-heading box-inline">{{ allmsg[loop.index-1].email }}</a>
                                    <p class="text-muted text-sm">{{ allmsg[loop.index-1].datecomment|date('Y-m-d H:m:s') }}</p>
                                </div>
                                <p>{{ allmsg[loop.index-1].message }}</p>
                                <hr>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}